<%- include('../layouts/user/header.ejs')%>
<%- include('../layouts/user/navbar.ejs')%>

    <!--================Header Area =================-->
    
    <!--================Header Area =================-->

    <!--================Banner Area =================-->


    <section class="light section_gap">
        <section class="h-100 gradient-custom">
            <div class="container py-5 h-100">


                <div class="card ">
                    <div class="card-header d-flex text-dark">
                        <h4 style="font-weight: 600; ">Booking Id:  <span style="font-size: small;"><%=Bookingdata.bookingId %> </span></h4>
                        <h5 class="ml-auto">Booked by <a href="/Userpage"><span><%=Bookingdata.bookerName %></span></a>  </h5>
                    </div>
                    <div class="card-body">
                        <div class="">
                            <div class="row">

                                <div class="col-md-9 mt-sm-20 left-align-p">
                                    <div class="text-dark">
                                        <h5 style="font-weight: 600;"> <%=Bookingdata.ResortName.resortName %></h5>
                                    </div>

                                    <div class="mt-4 text-primary">
                                        <h5 style="font-weight: 600;"> <i class="mdi mdi-map-marker"></i> <%=Bookingdata.ResortName.resortLocation %></h5>
                                    </div>

                                    <div class="mt-5 text-dark">
                                        <h5 style="font-weight: 600;">
                                            Discription
                                        </h5>
                                        <p>
                                            <%=Bookingdata.ResortName.resortDiscription %>
                                        </p>
                                    </div>


                                </div>
                                <div class="col-md-3">
                                    <img src="/resortImages/<%=Bookingdata.ResortName.resortsOtherImages[0]%>" alt="" class="img-fluid">
                                </div>
                            </div>
                        </div>

                        <hr style="width: 90%; margin-left: 5%;">
                        <div class="row">

                            <div class="col-6 col-lg-4  col-md-6 col-sm-6 ">
                                <div class="single-footer-widget mt-2 text-dark">
                                    <p class="">
                                        Primary Gust
                                    </p>
                                    <h5 style="font-weight: 600; text-transform: uppercase;"><%=Bookingdata.bookerName %></h5>
                                    <p class="">
                                        Mobile Number
                                    </p>
                                    <h5 style="font-weight: 600;"><%=Bookingdata.bookerNumber %></h5>
                                    <p class="">
                                        Email Address
                                    </p>
                                    <h5 style="font-weight: 600;"><%=Bookingdata.bookerEmail %></h5>
                                </div>
                            </div>
                            <div class="col-6 col-lg-4  col-md-6 col-sm-6 ">
                                <div class="single-footer-widget mt-2 text-dark">
                                    <p class="">
                                        Ceck In
                                    </p>
                                    <h5 style="font-weight: 600;"><%=Bookingdata.CurrentBookingData.toLocaleDateString() %></h5>
                                    <p class="">
                                        Cheak Out
                                    </p>
                                    <h5 style="font-weight: 600;"><%=Bookingdata.cheakoutDate.toLocaleDateString() %></h5>
                                </div>
                            </div>
                            
                            <div class="col-lg-4 col-md-6 col-sm-6 mt-2 text-dark">
                                <div class="single-footer-widget">
                                    <p class="">
                                        Number Of Rooms
                                    </p>
                                    <h5 style="font-weight: 600;"><%=Bookingdata.ResortName.resortRooms %> Rooms</h5>
                                    <p class="">
                                        Totel Amount
                                    </p>
                                    <h4 style="font-weight: 600;"> ₹ <%=Bookingdata.ResortName.resortPrice %></h4>
                                    <div class="text-danger row" id="bookingCancel" >
                                    <% if(Bookingdata.status=="cancelled"){ %>
                                    <a  style="font-size: 16px;" class="genric-btn bg-danger text-light circle arrow mt-3" >Cancelled <i style="font-size: 20px;" class="mdi mdi-close-octagon-outline ml-1"></i> </a>

                                    <% }else{ %>
                                    <a href="#"  style="font-size: 16px;" class="genric-btn danger-border circle arrow mt-3" type="button" onclick=" CancelOrder('<%=Bookingdata._id%>')">Cancel Booking<i style="font-size: 20px;" class="mdi mdi-help"></i></a>
                                    <%}  %>
                                </div>
                                </div>
                            </div>
                        </div>

                        <hr style="width: 90%; margin-left: 5%;">
                        <div class="row col-lg-12">
                            <a href="#" type="button" data-toggle="modal" data-target="#ReportComplante" style="font-size: 16px;" class="genric-btn primary-border  arrow ml-2 ">Report Complaint <i style="font-size: 20px;" class="mdi mdi-help"></i></a>
                            <a href="#"  style="font-size: 16px;" data-toggle="modal" data-target="#AddReviews" class="genric-btn info-border ml-auto" type="button" >Add Review<i style="font-size: 20px;" class="mdi mdi-plus"></i></a>

                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- modal  -->








<!-- Button trigger modal -->
<!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
    Launch demo modal
  </button> -->
  
  <!-- Modal -->
  <div class="modal fade" id="ReportComplante" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="background-color: rgba(0, 0, 0, 0.571);">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-danger" id="exampleModalLongTitle">Report your Complainte</h5>
            <form action="" method="" id="registercompainte">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <textarea id="description" name="complainte" rows="5" cols="60"></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" class="genric-btn danger-border circle arrow mt-3 " data-dismiss="modal">Close</button>
          <button type="submit" class="genric-btn danger-border circle arrow mt-3">Register Complante</button>
    </form>

        </div>
      </div>
    </div>
  </div>

  <div class="modal modal_outer right_modal fade" id="AddReviews" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2">
  <div class="modal-dialog" role="document">


      <form method="" id="PostReview" action="">

          <div class="modal-content text-center align-items-center">
        
            <h4 style="color: black;" class="pt-4">Thanks For Your Stay</h4>

              <!-- <input type="hidden" name="email_e" value="admin@filmscafe.in"> -->
                                   			
              
              <div class="row mt-4 card-header">
                <div class="img">
                    <img src="/resortImages/<%=Bookingdata.ResortName.resortsOtherImages[0]%>" style="height: 100px; width: 100px; border-radius: 10px;" alt="">
                </div>
                <div class="text">
                    <h4 style="font-weight: 600;" class="ml-4 mt-4"> <%=Bookingdata.ResortName.resortName %></h4>
                </div>
              </div>
              <div class="modal-body get_quote_view_modal_body">

                      <div class="col-md-12">
                        <div class="form-group mt-3">
                            <label for="" style="font-size: larger; font-weight: 600;"> Review Title</label>
                            <textarea name="reviewTitle" id="" cols="50" rows="1"></textarea>
           
                             </div>
                          <div class="form-group mt-3">
                            <label for="" style="font-size: larger; font-weight: 600;"> Write Your Review Here</label>
 
                            <textarea name="ReviewBody" id="" cols="50" rows="5"></textarea>
                              <input type="text" hidden name="resortId" value="<%=Bookingdata.ResortName._id%>">
                          </div>
                      </div>

                

              </div>
              <div class="modal-footer">
                  <button type="reset" class="btn theme_btn button_hover2 mr-auto" data-dismiss="modal">
                      Cancel</button>
                  <button type="submit" value="submit" class="btn theme_btn button_hover ml">Update</button>

              </div>

          </div><!-- //modal-content -->
      </form>
  </div><!-- modal-dialog -->
</div>


        <!--================ start footer Area  =================-->
        <footer class="footer-area section_gap">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3  col-md-6 col-sm-6">
                        <div class="single-footer-widget">
                            <h6 class="footer_title">About Agency</h6>
                            <p>The world has become so fast paced that people don’t want to stand by reading a page
                                of information, they would much rather look at a presentation and understand the
                                message. It has come to a point </p>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6">
                        <div class="single-footer-widget">
                            <h6 class="footer_title">Navigation Links</h6>
                            <div class="row">
                                <div class="col-4">
                                    <ul class="list_style">
                                        <li><a href="#">Home</a></li>
                                        <li><a href="#">Feature</a></li>
                                        <li><a href="#">Services</a></li>
                                        <li><a href="#">Portfolio</a></li>
                                    </ul>
                                </div>
                                <div class="col-4">
                                    <ul class="list_style">
                                        <li><a href="#">Team</a></li>
                                        <li><a href="#">Pricing</a></li>
                                        <li><a href="#">Blog</a></li>
                                        <li><a href="#">Contact</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6">
                        <div class="single-footer-widget">
                            <h6 class="footer_title">Newsletter</h6>
                            <p>For business professionals caught between high OEM price and mediocre print and
                                graphic output, </p>
                            <div id="mc_embed_signup">
                                <form target="_blank"
                                    action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                    method="get" class="subscribe_form relative">
                                    <div class="input-group d-flex flex-row">
                                        <input name="EMAIL" placeholder="Email Address" onfocus="this.placeholder = ''"
                                            onblur="this.placeholder = 'Email Address '" required="" type="email">
                                        <button class="btn sub-btn"><span class="lnr lnr-location"></span></button>
                                    </div>
                                    <div class="mt-10 info"></div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6">
                        <div class="single-footer-widget instafeed">
                            <h6 class="footer_title">InstaFeed</h6>
                            <ul class="list_style instafeed d-flex flex-wrap">
                                <li><img src="/imageFront/instagram/Image-01.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-02.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-03.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-04.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-05.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-06.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-07.jpg" alt=""></li>
                                <li><img src="/imageFront/instagram/Image-08.jpg" alt=""></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="border_line"></div>
                <div class="row footer-bottom d-flex justify-content-between align-items-center">
                    <p class="col-lg-8 col-sm-12 footer-text m-0">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        Copyright &copy;
                        <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                        template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a
                            href="https://colorlib.com" target="_blank">Colorlib</a>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </p>
                    <div class="col-lg-4 col-sm-12 footer-social">
                        <a href="#"><i class="fa fa-facebook"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                        <a href="#"><i class="fa fa-dribbble"></i></a>
                        <a href="#"><i class="fa fa-behance"></i></a>
                    </div>
                </div>
            </div>
        </footer>
        <!--================ End footer Area  =================-->







<script>

    function CancelOrder(BookingId){

        Swal.fire({
      title: 'Are you sure?',
      text: "You wan't to cancell order!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'yes, remove!'
    }).then((result)=>{
        if(result.isConfirmed){
            console.log(BookingId);
            console.log("helooo")
            $.ajax({
                url:"/cancelBooking",
                data:{
                    BookingId:BookingId
                },
                method:"post",
                success:(Response)=>{
                    if(Response.success){

                        // location.href='/ViewSeprateBooking'/BookingId,
                        $('#bookingCancel').html("Cancelled")

                        // $('#bookingCancel').load('/ViewSeprateBooking #bookingCancel' )
                        Swal.fire({
                            title: 'remove!',
                text: 'Item removed from Booking',
                icon: 'success',
                timer: 1000,
                showConfirmButton: false

                        })
                    }
                }
                
            })
        }
    })
    }












    const form = document.querySelector('#registercompainte')
        $('#registercompainte').submit(function (e) {
            e.preventDefault()
            let formData = $(this).serialize()
            const inputs = document.querySelectorAll('#registercompainte input')
            console.log(inputs);
            console.log(formData);
            let inputField = false
            for (let i = 0; i < inputs.length; i++) {
                if (inputs[i].value.trim() == '') {
                    inputField = true
                    $('#alertfield').attr({ style: 'display:block' }).html('All fields Required')
                    setTimeout(() => {
                        $('#alertfield').hide()
                    }, 3000)
                    break; // stop the loop if any input is empty
                }
            }
            if (!inputField) {
                $.ajax({
                    url: '/complanteRegister',
                    data: formData,
                    method: 'post',
                    success: (Response) => {
                        // handle the response from the server
                        console.log(Response);
                        if (Response) {

                            $('#ReportComplante').on('hidden.bs.modal', function () {

                                // $(this).find('form').trigger('reset');
                            });
                            $('#ReportComplante').modal('hide');
                            Swal.fire({
                            icon: 'success',
                            title: 'Oops...',
                            text: 'Complainte registred'
                        })
                            // $('#userDataCnt').load('/Userpage #userDataCnt')
                        }
                    }
                })
            }
        })   



        const review = document.querySelector('#PostReview')
        $('#PostReview').submit(function (e) {
            e.preventDefault()
            let ReviewData = $(this).serialize()
            const inputs = document.querySelectorAll('#PostReview input')
            console.log(inputs);
            console.log(ReviewData);
            let inputField = false
            for (let i = 0; i < inputs.length; i++) {
                if (inputs[i].value.trim() == '') {
                    inputField = true
                    $('#alertfield').attr({ style: 'display:block' }).html('All fields Required')
                    setTimeout(() => {
                        $('#alertfield').hide()
                    }, 3000)
                    break; // stop the loop if any input is empty
                }
            }
            if (!inputField) {
                $.ajax({
                    url: '/userReviews',
                    data: ReviewData,
                    method: 'post',
                    success: (Response) => {
                        // handle the response from the server
                        console.log(Response);
                        if (Response) {

                            $('#AddReviews').on('hidden.bs.modal', function () {

                                // $(this).find('form').trigger('reset');
                            });
                            $('#AddReviews').modal('hide');
                            Swal.fire({
                            icon: 'success',
                            title: 'Oops...',
                            text: 'Complainte registred'
                        })
                            // $('#userDataCnt').load('/Userpage #userDataCnt')
                        }
                    }
                })
            }
        })   
</script>

        <%- include('../layouts/user/footer.ejs')%>